package me.fengorz.leetcode.queue.task_scheduler;
//ç»™å®šä¸€ä¸ªç”¨å­—ç¬¦æ•°ç»„è¡¨ç¤ºçš„ CPU éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡åˆ—è¡¨ã€‚å…¶ä¸­åŒ…å«ä½¿ç”¨å¤§å†™çš„ A - Z å­—æ¯è¡¨ç¤ºçš„26 ç§ä¸åŒç§ç±»çš„ä»»åŠ¡ã€‚ä»»åŠ¡å¯ä»¥ä»¥ä»»æ„é¡ºåºæ‰§è¡Œï¼Œå¹¶ä¸”æ¯ä¸ªä»»åŠ¡
//éƒ½å¯ä»¥åœ¨ 1 ä¸ªå•ä½æ—¶é—´å†…æ‰§è¡Œå®Œã€‚CPU åœ¨ä»»ä½•ä¸€ä¸ªå•ä½æ—¶é—´å†…éƒ½å¯ä»¥æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œæˆ–è€…åœ¨å¾…å‘½çŠ¶æ€ã€‚ 
//
// ç„¶è€Œï¼Œä¸¤ä¸ªç›¸åŒç§ç±»çš„ä»»åŠ¡ä¹‹é—´å¿…é¡»æœ‰é•¿åº¦ä¸º n çš„å†·å´æ—¶é—´ï¼Œå› æ­¤è‡³å°‘æœ‰è¿ç»­ n ä¸ªå•ä½æ—¶é—´å†… CPU åœ¨æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ï¼Œæˆ–è€…åœ¨å¾…å‘½çŠ¶æ€ã€‚ 
//
// ä½ éœ€è¦è®¡ç®—å®Œæˆæ‰€æœ‰ä»»åŠ¡æ‰€éœ€è¦çš„æœ€çŸ­æ—¶é—´ã€‚ 
//
// 
//
// ç¤ºä¾‹ ï¼š 
//
// è¾“å…¥ï¼štasks = ["A","A","A","B","B","B"], n = 2
//è¾“å‡ºï¼š8
//è§£é‡Šï¼šA -> B -> (å¾…å‘½) -> A -> B -> (å¾…å‘½) -> A -> B.
//     åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œä¸¤ä¸ªç›¸åŒç±»å‹ä»»åŠ¡ä¹‹é—´å¿…é¡»é—´éš”é•¿åº¦ä¸º n = 2 çš„å†·å´æ—¶é—´ï¼Œè€Œæ‰§è¡Œä¸€ä¸ªä»»åŠ¡åªéœ€è¦ä¸€ä¸ªå•ä½æ—¶é—´ï¼Œæ‰€ä»¥ä¸­é—´å‡ºç°äº†ï¼ˆå¾…å‘½ï¼‰çŠ¶æ€ã€‚ 
//
// 
//
// æç¤ºï¼š 
//
// 
// ä»»åŠ¡çš„æ€»ä¸ªæ•°ä¸º [1, 10000]ã€‚ 
// n çš„å–å€¼èŒƒå›´ä¸º [0, 100]ã€‚ 
// 
// Related Topics è´ªå¿ƒç®—æ³• é˜Ÿåˆ— æ•°ç»„
// ğŸ‘ 370 ğŸ‘ 0


import java.util.*;

//leetcode submit region begin(Prohibit modification and deletion)
public class Solution {
    /**
     * ä¼˜å…ˆé˜Ÿåˆ—è§£æ³•
     *
     * @param tasks
     * @param n
     * @return
     */
    public int leastInterval(char[] tasks, int n) {
        final char A = 'A';
        // ä½¿ç”¨charä¸intå€¼å¯¹åº”å…³ç³»å®šä¹‰ä¸€ä¸ªintæ•°ç»„æ¥ä»£æ›¿26ä¸ªå­—æ¯
        int[] alphabet = new int[26];
        for (char letter : tasks) {
            alphabet[letter - A]++;
        }
        // å‡å®šæ¯ä¸€è½®æ‰§è¡Œçš„è®¡ç®—æ˜¯n+1ï¼Œn+1èƒ½å¤Ÿç¡®ä¿æ¯ä¸€è½®è®¡ç®—ä¸­æ²¡æœ‰å‡ºç°é‡å¤çš„å­—æ¯
        // æ¯”å¦‚n=2ï¼Œæ¯ä¸€è½®å½“ä¸­ï¼Œä¸å¯èƒ½å‡ºç°A->*->Açš„æƒ…å†µï¼Œä¸€å®šæ˜¯A->*->*
        // ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ¥è£…26ä¸ªå­—æ¯ä¾æ¬¡åœ¨tasksé‡Œé¢å‡ºç°çš„æ¬¡æ•°ï¼Œæ¯ä¸€è½®å…ˆè¢«æ‹¿å‡ºæ¥çš„å­—æ¯ä¼˜å…ˆæƒä¸å­—æ¯å‡ºç°æ¬¡æ•°å‘ˆæ­£ç›¸å…³
        // è¦ä½¿ç”¨åå‘æ’åºCollections.reverseOrder()ï¼Œå› ä¸ºPriorityQueueæ˜¯å‘ˆç°å‡åºä¼˜å…ˆçš„
        Queue<Integer> queue = new PriorityQueue<>(26, Collections.reverseOrder());
        for (int letterSum : alphabet) {
            // å¦‚æœå­—æ¯åœ¨tasksä¸­ä¸å­˜åœ¨ï¼Œå°±æ²¡æœ‰å¿…è¦å…¥é˜Ÿ
            if (letterSum > 0) {
                queue.add(letterSum);
            }
        }
        // æ€»å…±çš„èŠ±è´¹æ—¶é—´å•ä½
        int time = 0;
        // ä¸´æ—¶é˜Ÿåˆ—ä¸è¦æ”¾åˆ°å¾ªç¯ä½“é‡Œé¢å»åˆ›å»ºï¼Œè¿™æ˜¯ä¸€ä¸ª"çƒ­ç‚¹å®¹å™¨"
        List<Integer> transition = new LinkedList<>();
        while (!queue.isEmpty()) {
            // å½“å‰è½®å·²æ‰§è¡Œçš„æ—¶é—´å•ä½
            int roundCursor = 0;
            // æ¯ä¸ªå­—æ¯çš„å­˜é‡
            int poll = 0;
            while (roundCursor <= n) {
                if (!queue.isEmpty()) {
                    poll = queue.poll();
                    if (poll > 1) {
                        // è¯¥å­—æ¯ä»»åŠ¡è¢«è®¡ç®—ï¼Œéœ€è¦-1
                        transition.add(poll - 1);
                    }
                }
                time++;
                // å¦‚æœæ˜¯æœ€åä¸€è½®çš„æƒ…å†µä¸‹ï¼Œå³è¾¹è¿ç»­çš„å¾…å‘½ä»»åŠ¡ä¸è®¡å…¥æ€»çš„æ—¶é—´å•ä½
                if (queue.isEmpty() && transition.isEmpty()) {
                    break;
                }
                roundCursor++;
            }
            // è¿è¡Œè¿‡çš„å­—æ¯å¦‚æœè¦æœ‰å­˜é‡ï¼Œè¦ç»§ç»­æ‰”ä¼šé˜Ÿåˆ—è®¡ç®—
            queue.addAll(transition);
            transition.clear();
        }
        return time;
    }

    /**
     * æ’åºè§£æ³•ï¼Ÿ
     *
     * @param tasks
     * @param n
     * @return
     */
    public int leastInterval_sort(char[] tasks, int n) {
        // TODO ZSF nå¤šç§æ’åºæœ‰å¾…æ·±å…¥å­¦ä¹ 
        return 0;
    }


}
//leetcode submit region end(Prohibit modification and deletion)
